[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Centrality analysis on Rio Grande do Sul",
    "section": "",
    "text": "Data and Software Availability\nThis document is written following the Reproducibiltiy paper guidelines for the AGILE conference 2025 (Belliard et al. 2019) .The following flowchart explains the methodology to analyse the centrality and resilience of the road network and healthcare facilities in the core metropolitan area of Rio Grande do Sul."
  },
  {
    "objectID": "index.html#datasets",
    "href": "index.html#datasets",
    "title": "Centrality analysis on Rio Grande do Sul",
    "section": "Datasets",
    "text": "Datasets\nThe table 1 summaries the initial data from which intermediate and final results are derived. The section link includes the origin of the data, so third parties to reuse. In addition, the public github repository with open data license also provide the data of the study.\nThe total built-up volume weighted the sampling of the origin and destination and is accessible via the following DOI:10.2905/AB2F107A-03CD-47A3-85E5-139D8EC63283. The degree of urbanization determined the urban dense settlement analysed contained the 9 municipalities that comprises the studied area named core metropolitan area and is accessible via the following DOI:10.2905/A0DF7A6F-49DE-46EA-9BDE-563437A6E2BA.Similarly, the subset of the flood is derived from the cheias_rhguaiba_2024_db_v11.gpkg accesible in the DOI:10.5281/zenodo.11164049. We also incorporated data from the Brazilian Institute of Geography and Statistics (IBGR) 1 to add the GPD of the municipalities or from the Economy and Statistics Department of Rio Grande do Sul State(DEE-SPGG) 2 about the population affected by the flood. For the hospitals, we used the dataset Hospitais_com_Leitos_de_UTIs_no_RS.geojson that included the bed capacity and is accessible via the DOI:10.7303/syn32211006.1. The location of the healthcare facility is obtained using the WFS provided by “Secretaria Estadual da Saúde/DGTI”.\n\nTable 1: Original raw datasets\n\n\nData\nDescription\nLink\n\n\n\n\nGHSL-Built-V\ntotal built-up volume in m³\nGHSL-Built-V\n\n\nGHSL-SMOD\nDegree of Urbanisation\nGHSL-SMOD\n\n\ncheias_rhguaiba_2024_db_v11.gpkg\nFlood extent obtained on the 29th April, 2024\nFlood extent\n\n\nETLCNES_SR_RS_21_12_t.csv\nIt includes ICU beds of healthcare facilities\nHospital data\n\n\nHospitais_com_Leitos_de_UTIs_no_RS.geojson\nIt includes healthcare facilities with ICU\nHospitals\n\n\ngeoBoundaries-BRA-ADM2\nIt contains subnational administrative boundaries in Brazil\nAdmiministrative units\n\n\nOpenStreetMap data\nIt represents the road network in the region of Sul, in Brazil\nOSM data"
  },
  {
    "objectID": "index.html#computational-workflows",
    "href": "index.html#computational-workflows",
    "title": "Centrality analysis on Rio Grande do Sul",
    "section": "Computational workflows",
    "text": "Computational workflows\n\n\n\n\n\n\n\n\nLane\nActivity\nTime\n\n\n\n\nSelect Area of Interest (AOI)\nFlood extent:\nXs\n\n\nSelect Area of Interest (AOI)\nObtain road network\nXs\n\n\nObtain routable network\nTransform into graph: Convert into graph\nXs\n\n\nObtain routable network\nTransform into graph: Export geometry\nXs\n\n\nObtain routable network\nExtract difference: Subset flood extent\nXs\n\n\nObtain routable network\nExtract difference: Post-disaster network\nXs\n\n\nAnalyse centrality and resilience\nWeighted OD\nXs\n\n\nAnalyse centrality and resilience\nRegular OD\nXs\n\n\nAnalyse centrality and resilience\nCalculate connectivity: RQ1: C.Metropolitan scale\nXs\n\n\nAnalyse centrality and resilience\nCalculate connectivity: RQ2: Intracity Scale\nXs\n\n\nAnalyse centrality and resilience\nCalculate resilience: RQ3: Resilience-lack of redundancy\nXs\n\n\n\n\nComputational environment\n\nPostgreSQL 15.3 is used from the docker file container that includes the extension PostGIS 16-3.4-v2024.03.17 and pgrouting 3.5.\nThe libraries that includes the study analysis, visualization and creation of this documentation is available with the renv file.\nThe study required a CPU Intel(R) Core(TM) i5-4300U CPU @ 1.90 GHz with 15 Gi model HP EliteBook 820 G1.\nQGIS Version 3.38 ‘Grenoble’\nRStudio 2023.06.1+524 “Mountain Hydrangea”\nopenrouteservice:v8.0.0 used following the described docker file container instructions\n\n\n\nComputation steps\nThis Quarto book describes the detailed steps carried out for this use case in three chapters that contains the workflow described in the Fig 1 with 8 activities.\n\n\n\n\nBelliard, Frederique, Rusne Sileryte, Anita Graser, Karl Broman, Marta Teperek, Carlos Granell, Barbara Hofer, et al. 2019. “AGILE Reproducible Paper Guidelines.” https://doi.org/10.17605/OSF.IO/CB7Z8."
  },
  {
    "objectID": "intro.html#importing-data-into-postgresql",
    "href": "intro.html#importing-data-into-postgresql",
    "title": "Select AoI",
    "section": "Importing data into PostgreSQL",
    "text": "Importing data into PostgreSQL\n\n\nImporting source data using ogr2ogr and shp2pgsql\n# Urban Center to select core metropolitan area (2.514s)\ntime shp2pgsql -D -I -s 54009:4326 GHS_SMOD_E2020_GLOBE_R2023A_54009_1000_UC_V2_0.shp agile_gis_2025_rs.urban_center_4326 | psql -p 25432 -U docker -d gis  -h localhost\n# Hospitals (0.217s)\ntime ogr2ogr -f PostgreSQL PG:\"host=localhost port= 25432 user=docker password=docker dbname=gis schemas=agile_gis_2025_rs\" Hospitais_com_Leitos_de_UTIs_no_RS.geojson -nln hospitals \n# Administrative units (5.854s)\ntime ogr2ogr -f PostgreSQL PG:\"host=localhost port= 25432 user=docker password=docker dbname=gis schemas=agile_gis_2025_rs\" geoBoundaries-BRA-ADM2.geojson -nln nuts\n#  Flood extent (1.008s)\ntime ogr2ogr -f PostgreSQL PG:\"host=localhost port= 25432 user=docker password=docker dbname=gis schemas=agile_gis_2025_rs\" rhguaiba_planetskysat_inundacao_obs_20240506.gpkg -nln flooding_raw"
  },
  {
    "objectID": "intro.html#connecting-r-with-postgresql",
    "href": "intro.html#connecting-r-with-postgresql",
    "title": "Select AoI",
    "section": "Connecting R with PostgreSQL",
    "text": "Connecting R with PostgreSQL\n\n\nShow the code\nlibrary(DBI)\nlibrary(dplyr)\n## connect to PostgreSQL\nconnection &lt;- DBI::dbConnect(RPostgres::Postgres(),\n                             user=\"docker\",\n                             password=\"docker\",\n                             host=\"localhost\",\n                             dbname=\"gis\",\n                             port=25432)\n## Connect to PostgreSQL to read CSV without defining in PostgreSQL\nlibrary(tictoc)\ntic()\netlcnes_hospital_selected &lt;- read.csv(\"~/agile_giscience_2025_github/agile-gscience-2024-rs-flood/data/source_data/ETLCNES_SR_RS_21_12_t.csv\") |&gt; \n                          dplyr::select(c(\"CNES\",\"QTLEITP1\",\"QTLEITP2\",\"QTLEITP3\",\"NAT_JUR\"))\ntoc() # 54.361 sec elapsed\n## Write table using PostgreSQL connection\nDBI::dbWriteTable(connection, DBI::Id(schema=\"agile_gis_2025_rs\",table=\"etlcnes_hospital_selected\"))"
  },
  {
    "objectID": "intro.html#footnotes",
    "href": "intro.html#footnotes",
    "title": "Select AoI",
    "section": "",
    "text": "https://download.geofabrik.de/south-america/brazil/sul.html#↩︎"
  },
  {
    "objectID": "detect_flood.html",
    "href": "detect_flood.html",
    "title": "1  Detect flood",
    "section": "",
    "text": "Work in progress, waiting for acceptance."
  },
  {
    "objectID": "obtain_road_network.html",
    "href": "obtain_road_network.html",
    "title": "2  Obtain road network",
    "section": "",
    "text": "Work in progress, waiting for acceptance."
  },
  {
    "objectID": "obtain_routable_network.html",
    "href": "obtain_routable_network.html",
    "title": "Obtain routable network",
    "section": "",
    "text": "Work in progress, waiting for acceptance."
  },
  {
    "objectID": "transform_into_graph.html",
    "href": "transform_into_graph.html",
    "title": "3  Transform into graph",
    "section": "",
    "text": "Work in progress, waiting for acceptance."
  },
  {
    "objectID": "extract_difference.html",
    "href": "extract_difference.html",
    "title": "4  Extract difference",
    "section": "",
    "text": "Work in progress, waiting for acceptance."
  },
  {
    "objectID": "analyse_centrality_resilience.html",
    "href": "analyse_centrality_resilience.html",
    "title": "Analysis Centrality and Resilience",
    "section": "",
    "text": "Work in progress, waiting for acceptance."
  },
  {
    "objectID": "od.html",
    "href": "od.html",
    "title": "5  Origin-Destination matrix",
    "section": "",
    "text": "Work in progress, waiting for acceptance."
  },
  {
    "objectID": "calculate_short_path.html",
    "href": "calculate_short_path.html",
    "title": "6  Calculate short path",
    "section": "",
    "text": "Work in progress, waiting for acceptance."
  },
  {
    "objectID": "calculate_connectivity.html#rq1",
    "href": "calculate_connectivity.html#rq1",
    "title": "7  Calculate connectivity",
    "section": "7.1 RQ1",
    "text": "7.1 RQ1"
  },
  {
    "objectID": "calculate_connectivity.html#rq2",
    "href": "calculate_connectivity.html#rq2",
    "title": "7  Calculate connectivity",
    "section": "7.2 RQ2",
    "text": "7.2 RQ2\nWork in progress, waiting for acceptance."
  },
  {
    "objectID": "calculate_redundancy.html#rq3",
    "href": "calculate_redundancy.html#rq3",
    "title": "8  Calculate redundancy",
    "section": "8.1 RQ3",
    "text": "8.1 RQ3\nWork in progress, waiting for acceptance."
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Belliard, Frederique, Rusne Sileryte, Anita Graser, Karl Broman, Marta\nTeperek, Carlos Granell, Barbara Hofer, et al. 2019. “AGILE\nReproducible Paper Guidelines.” https://doi.org/10.17605/OSF.IO/CB7Z8.\n\n\nPCDaS. 2022. “ETLCNES_SR.zip.” Synapse. https://doi.org/10.7303/SYN32211006.1.\n\n\nPossantti, Iporã, Ana Aguirre, Camila Alberti, Laura Azeredo, Mariana\nBarcelos, Fernando Becker, Mateus Camana, et al. 2024. “Banco de\nDados Das Cheias Na Região Hidrográfica Do Lago Guaíba Em Maio de\n2024.” Zenodo. https://doi.org/10.5281/ZENODO.13999016.\n\n\nRunfola, Daniel, Austin Anderson, Heather Baier, Matt Crittenden,\nElizabeth Dowker, Sydney Fuhrig, Seth Goodman, et al. 2020.\n“geoBoundaries: A Global Database of Political Administrative\nBoundaries.” Edited by Wenwu Tang. PLOS ONE 15 (4):\ne0231866. https://doi.org/10.1371/journal.pone.0231866.\n\n\nSchiavina, Marcello, Michele Melchiorri, and Martino Pesaresi. 2023.\n“GHS-SMOD R2023A - GHS Settlement Layers, Application of the\nDegree of Urbanisation Methodology (Stage i) to GHS-POP R2023A and\nGHS-BUILT-s R2023A, Multitemporal (1975-2030).” European\nCommission, Joint Research Centre (JRC). https://doi.org/10.2905/A0DF7A6F-49DE-46EA-9BDE-563437A6E2BA."
  },
  {
    "objectID": "intro.html#data-wranging",
    "href": "intro.html#data-wranging",
    "title": "Select AoI",
    "section": "Data wranging",
    "text": "Data wranging\n\nVector data\n\n\nShow the code\n---- Dense urban center that intersects with Porto Alegre -&gt; ***Input for leaflet map***\nEXPLAIN ANALYZE\nCREATE TABLE urban_center_4326_core AS\nSELECT \n    duc.* \nFROM \n    urban_center_4326 AS duc,\n    (SELECT \n        * \n     FROM \n        nuts_shp \n     WHERE\n        shapename = 'Porto Alegre') AS porto_alegre\nWHERE\n    st_intersects(\n        duc.geom,\n        porto_alegre.geom);\n--- 13.714 ms\n\n--- Municipalities contained in the urban_center_4326\nEXPLAIN ANALYZE \nCREATE TABLE municipalities_ghs AS\nWITH porto_alegre_ghs AS(\n    SELECT \n       ghs.*\n    FROM\n       urban_center_4326 AS ghs\n    JOIN\n       nuts \n    ON \n       st_intersects(nuts.wkb_geometry, ghs.geom)\n    WHERE \n        nuts.shapename = 'Porto Alegre'),\nmunicipalities_ghs_geom AS (\n    SELECT\n        municipalities.*\n    FROM \n        nuts AS municipalities,\n        porto_alegre_ghs AS ghs\n    WHERE\n        st_intersects(municipalities.wkb_geometry, ghs.geom))\n    SELECT * FROM municipalities_ghs_geom; --- 19.062ms\n    \n---- Defined core metropolitan area of the municipalities_ghs\nEXPLAIN ANALYZE\nCREATE TABLE core_metropolitan_area AS\nSELECT \n    st_union(wkb_geometry) AS geom\nFROM \nmunicipalities_ghs; --- 15.382ms\n---- Hospitals with ICU and their bed capacity -&gt; ***Input for leaflet map****\n\n\nEXPLAIN ANALYZE\nCREATE TABLE hospital_bed_aux_leaflet AS\nSELECT \n    h.fid,\n    initcap(h.ds_cnes) AS ds_cnes,\n    h.tp_risco,\n    h.nm_municip,\n    h.ds_bairro,\n    h.addr_ct,\n    h.geom_hospital,\n    h.distance,\n        aux_data.\"QTLEITP1\",\n    aux_data.\"QTLEITP2\",\n    aux_data.\"QTLEITP3\",\n    \"QTLEITP1\"+\"QTLEITP2\"+\"QTLEITP3\" AS beds,\n    aux_data.\"NAT_JUR\",\n    CASE\n        WHEN \"NAT_JUR\" IN (3069,3999)\n        THEN 'Private' ELSE 'Public'  \n    END AS nat_jur_cat,\n    initcap(h.nm_razao_s) AS nm_razao_s\nFROM \n    etlcnes_hospital_selected AS aux_data\nJOIN\n    municipalities_ghs_hospitals AS h\nON\n    h.cd_cnes = aux_data.\"CNES\"; ---- Execution Time: 43.901 ms\n    \n--- Municipality of the AoI with additonial data from:\n------- A) IBGR: \"https://www.ibge.gov.br/cidades-e-estados/rs/\"\n--------B) DEE-SPGG: \"https://mup.rs.gov.br/\" \n--- -&gt; ***Input for leaflet map****\nEXPLAIN ANALYZE\nCREATE TABLE municipalities_ghs_leaflet AS\nSELECT shapename,\n     wkb_geometry\nFROM municipalities_ghs; ----  8.511 ms\n--- Add new fields (A,B)\nALTER TABLE municipalities_ghs_leaflet\n    ADD COLUMN \"Pop.Aff\" text,\n    ADD COLUMN \"GDP\" text ; --- 0.012S execute time\n--- Populate columns\nEXPLAIN ANALYZE\n    UPDATE municipalities_ghs_leaflet\nSET \"Pop.Aff\" = data.\"Pop.Aff\",\n    \"GDP\" = data.\"GDP\"\nFROM (VALUES\n    ('Alvorada', '26K (29%)', '15K'),\n    ('Cachoeirinha', '12K (9%)', '49K'),\n    ('Canoas', '157K (45%)', '63K'),\n    ('Esteio', '20K (26%)', '45K'),\n    ('Gravataí', '6K (2%)', '36K'),\n    ('Nova Santa Rita', '7K (24%)', '81K'),\n    ('Porto Alegre', '125K (9%)', '55K'),\n    ('Sapucaia do Sul', '6K (4%)', '29K'),\n    ('Viamão', '2K (1%)', '17K')\n) AS data(shapename, \"Pop.Aff\", \"GDP\")\nWHERE municipalities_ghs_leaflet.shapename = data.shapename; --- Execution Time: 0.596 ms\n\n\n\n\nRaster data\nWe used a subset of the GHS_BUILT_V available at origin and zenodo repository\n\n\nShow the code\n# Import data\nlibrary(sf)  # vector files\nlibrary(terra) # raster files\nlibrary(tictoc) # timing\ntic()\nbuildings_density_global &lt;- terra::rast(\n  '~/GHS_BUILT_V_E2020_GLOBE_R2023A_54009_100_V1_0.tif')\ntoc() ## 0.088 sec elapsed\ntic()\nmunicipalities_ghs_transformed &lt;- municipalities_ghs |&gt; st_transform(crs(buildings_density_global))\ntoc() ## 0.071 sec elapsed\ntic()\nbuilding_density_local_aoi &lt;- crop(buildings_density_global, municipalities_ghs_transformed)\ntoc() ## 0.074 sec elapsed\n## Reproject for sampling\ntic()\nbuilding_density_local_aoi_4326 &lt;- terra::project(building_density_local_aoi, crs(municipalities_ghs))\ntoc() ### 0.595 sec elapsed\ntic()\nbuilding_density_local_aoi_4326_masked &lt;- terra::mask(building_density_local_aoi_4326, municipalities_ghs) \ntoc() ## 0.089 sec elapsed\nterra::writeRaster(building_density_local_aoi_4326_masked, \"GHS_BUILT_V_E2020_GLOBE_R2023A_4326_100_V1_0_RioGrandeDoSul.tif\")\n### Reclassify values 0 with missing values (NA) to make them transparent in the leaflet map\nvalues(building_density_local_aoi_4326_masked)[values(building_density_local_aoi_4326_masked) == 0] = NA\n\n\n\n\n\n\nPCDaS. 2022. “ETLCNES_SR.zip.” Synapse. https://doi.org/10.7303/SYN32211006.1.\n\n\nPossantti, Iporã, Ana Aguirre, Camila Alberti, Laura Azeredo, Mariana Barcelos, Fernando Becker, Mateus Camana, et al. 2024. “Banco de Dados Das Cheias Na Região Hidrográfica Do Lago Guaíba Em Maio de 2024.” Zenodo. https://doi.org/10.5281/ZENODO.13999016.\n\n\nRunfola, Daniel, Austin Anderson, Heather Baier, Matt Crittenden, Elizabeth Dowker, Sydney Fuhrig, Seth Goodman, et al. 2020. “geoBoundaries: A Global Database of Political Administrative Boundaries.” Edited by Wenwu Tang. PLOS ONE 15 (4): e0231866. https://doi.org/10.1371/journal.pone.0231866.\n\n\nSchiavina, Marcello, Michele Melchiorri, and Martino Pesaresi. 2023. “GHS-SMOD R2023A - GHS Settlement Layers, Application of the Degree of Urbanisation Methodology (Stage i) to GHS-POP R2023A and GHS-BUILT-s R2023A, Multitemporal (1975-2030).” European Commission, Joint Research Centre (JRC). https://doi.org/10.2905/A0DF7A6F-49DE-46EA-9BDE-563437A6E2BA."
  },
  {
    "objectID": "index.html#footnotes",
    "href": "index.html#footnotes",
    "title": "Centrality analysis on Rio Grande do Sul",
    "section": "",
    "text": "https://www.ibge.gov.br/cidades-e-estados/rs/↩︎\nhttps://mup.rs.gov.br/↩︎"
  }
]